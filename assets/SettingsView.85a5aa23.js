import{d as E,o as I,c as N,w as O,a as f,u as d,b as ne,I as M,e as ve,Q,y as re,z as ue,m as h,D as T,x as k,S as K,B as _e,f as p,C as W,E as Y,F as be,G as U,r as ce,H as he,J as de,K as ye,n as B,i as Se,L as xe,M as De,O as we,P as Fe,T as Ce,U as Ee,V as Ie,W as oe,X as Ve,s as H,v as Z,g as X,Y as me,N as j,Z as Oe,h as Ne,_ as ae}from"./index.66b77c2e.js";import{Q as $e}from"./QPage.6bf7e2ad.js";import{_ as Te,a as ke}from"./TestLogsBtn.vue_vue_type_script_setup_true_lang.d24ff887.js";import{Q as Ae}from"./QChip.c7c0f1c4.js";import{h as Re}from"./format.3e32b8d9.js";const Me=E({__name:"SettingsHeader",setup(e){return(o,s)=>(I(),N(d(Q),{class:"bg-primary text-white q-py-sm text-h5"},{default:O(()=>[f(d(ne),{class:"q-pb-xs q-pr-sm",name:d(M).SETTINGS},null,8,["name"]),ve(" Settings ")]),_:1}))}}),qe=E({__name:"SettingToggles",setup(e){const o=re(),s=ue(),_=h({get(){return s.darkMode},async set(l){await T.updateById(k.SETTINGS,K.DARK_MODE,{settingValue:l}),s.darkMode=!!l,o.dark.set(l)}}),a=h({get(){return s.showConsoleLogs},async set(l){await T.updateById(k.SETTINGS,K.SHOW_CONSOLE_LOGS,{settingValue:l}),s.showConsoleLogs=!!l}}),u=h({get(){return s.showDebugMessages},async set(l){await T.updateById(k.SETTINGS,K.SHOW_DEBUG_MESSAGES,{settingValue:l}),s.showDebugMessages=!!l}}),m=h({get(){return s.saveInfoMessages},async set(l){await T.updateById(k.SETTINGS,K.SAVE_INFO_MESSAGES,{settingValue:l}),s.saveInfoMessages=!!l}});return(l,i)=>(I(),_e(be,null,[p("div",null,[f(d(Y),{modelValue:d(_),"onUpdate:modelValue":i[0]||(i[0]=n=>W(_)?_.value=n:null),label:"Dark Mode"},null,8,["modelValue"])]),p("div",null,[f(d(Y),{modelValue:d(a),"onUpdate:modelValue":i[1]||(i[1]=n=>W(a)?a.value=n:null),label:"Show Console Logs"},null,8,["modelValue"])]),p("div",null,[f(d(Y),{modelValue:d(u),"onUpdate:modelValue":i[2]||(i[2]=n=>W(u)?u.value=n:null),label:"Show Debug Messages"},null,8,["modelValue"])]),p("div",null,[f(d(Y),{modelValue:d(m),"onUpdate:modelValue":i[3]||(i[3]=n=>W(m)?m.value=n:null),label:"Save Info Messages"},null,8,["modelValue"])])],64))}}),Be=p("div",{class:"text-h6 q-mb-sm"},"Options",-1),je=p("div",{class:"q-mb-sm"},[p("span",null,"Dark Mode allows you to switch between a light or dark themed app."),p("span",null," Show Console Logs will display all log messages in the developer console when turned on. "),p("span",null,"Show Debug Messages will display debug level notification alerts when on."),p("span",null," Save Info Messages will save info level messages in the logs table of the database for later review. ")],-1),ze=E({__name:"OptionsSection",setup(e){return(o,s)=>(I(),N(d(Q),null,{default:O(()=>[Be,je,f(qe),f(Te,{class:"q-mt-sm"})]),_:1}))}}),Le=p("div",{class:"text-h6 q-mb-sm"},"Database Defaults",-1),Pe=p("div",{class:"q-mb-md"}," Load default data into the database that you can begin using right away. ",-1),Ue=E({__name:"DefaultsSection",setup(e){return(o,s)=>(I(),N(d(Q),null,{default:O(()=>[Le,Pe,f(ke)]),_:1}))}});function L(e,o,s,_){const a=[];return e.forEach(u=>{_(u)===!0?a.push(u):o.push({failedPropValidation:s,file:u})}),a}function J(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),de(e)}const Qe={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Ge=["rejected"];function Ke({editable:e,dnd:o,getFileInput:s,addFilesToQueue:_}){const{props:a,emit:u,proxy:m}=ce(),l=U(null),i=h(()=>a.accept!==void 0?a.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),n=h(()=>parseInt(a.maxFiles,10)),b=h(()=>parseInt(a.maxTotalSize,10));function S(t){if(e.value)if(t!==Object(t)&&(t={target:null}),t.target!==null&&t.target.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&he(t);else{const D=s();D&&D!==t.target&&D.click(t)}}function w(t){e.value&&t&&_(null,t)}function x(t,D,A,P){let c=Array.from(D||t.target.files);const C=[],R=()=>{C.length>0&&u("rejected",C)};if(a.accept!==void 0&&i.value.indexOf("*/")===-1&&(c=L(c,C,"accept",g=>i.value.some(y=>g.type.toUpperCase().startsWith(y)||g.name.toUpperCase().endsWith(y))),c.length===0))return R();if(a.maxFileSize!==void 0){const g=parseInt(a.maxFileSize,10);if(c=L(c,C,"max-file-size",y=>y.size<=g),c.length===0)return R()}if(a.multiple!==!0&&c.length>0&&(c=[c[0]]),c.forEach(g=>{g.__key=g.webkitRelativePath+g.lastModified+g.name+g.size}),P===!0){const g=A.map(y=>y.__key);c=L(c,C,"duplicate",y=>g.includes(y.__key)===!1)}if(c.length===0)return R();if(a.maxTotalSize!==void 0){let g=P===!0?A.reduce((y,ee)=>y+ee.size,0):0;if(c=L(c,C,"max-total-size",y=>(g+=y.size,g<=b.value)),c.length===0)return R()}if(typeof a.filter=="function"){const g=a.filter(c);c=L(c,C,"filter",y=>g.includes(y))}if(a.maxFiles!==void 0){let g=P===!0?A.length:0;if(c=L(c,C,"max-files",()=>(g++,g<=n.value)),c.length===0)return R()}if(R(),c.length>0)return c}function V(t){J(t),o.value!==!0&&(o.value=!0)}function v(t){de(t),(t.relatedTarget!==null||ye.is.safari!==!0?t.relatedTarget!==l.value:document.elementsFromPoint(t.clientX,t.clientY).includes(l.value)===!1)===!0&&(o.value=!1)}function q(t){J(t);const D=t.dataTransfer.files;D.length>0&&_(null,D),o.value=!1}function z(t){if(o.value===!0)return B("div",{ref:l,class:`q-${t}__dnd absolute-full`,onDragenter:J,onDragover:J,onDragleave:v,onDrop:q})}return Object.assign(m,{pickFiles:S,addFiles:w}),{pickFiles:S,addFiles:w,onDragover:V,onDragleave:v,processFiles:x,getDndNode:z,maxFilesNumber:n,maxTotalSizeNumber:b}}const We=Se({name:"QFile",inheritAttrs:!1,props:{...xe,...De,...Qe,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...we,...Ge],setup(e,{slots:o,emit:s,attrs:_}){const{proxy:a}=ce(),u=Fe(),m=U(null),l=U(!1),i=Ce(e),{pickFiles:n,onDragover:b,onDragleave:S,processFiles:w,getDndNode:x}=Ke({editable:u.editable,dnd:l,getFileInput:le,addFilesToQueue:se}),V=Ee(e),v=h(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),q=h(()=>oe(v.value)),z=h(()=>v.value.map(r=>r.name).join(", ")),t=h(()=>Re(v.value.reduce((r,F)=>r+F.size,0))),D=h(()=>({totalSize:t.value,filesNumber:v.value.length,maxFiles:e.maxFiles})),A=h(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:i.value,..._,id:u.targetUid.value,disabled:u.editable.value!==!0})),P=h(()=>"q-file q-field--auto-height"+(l.value===!0?" q-file--dnd":"")),c=h(()=>e.multiple===!0&&e.append===!0);function C(r){const F=v.value.slice();F.splice(r,1),g(F)}function R(r){const F=v.value.findIndex(r);F>-1&&C(F)}function g(r){s("update:modelValue",e.multiple===!0?r:r[0])}function y(r){r.keyCode===13&&Ve(r)}function ee(r){(r.keyCode===13||r.keyCode===32)&&n(r)}function le(){return m.value}function se(r,F){const $=w(r,F,v.value,c.value),te=le();te!=null&&(te.value=""),$!==void 0&&((e.multiple===!0?e.modelValue&&$.every(ge=>v.value.includes(ge)):e.modelValue===$[0])||g(c.value===!0?v.value.concat($):$))}function G(){return[B("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function fe(){if(o.file!==void 0)return v.value.length===0?G():v.value.map((F,$)=>o.file({index:$,file:F,ref:this}));if(o.selected!==void 0)return v.value.length===0?G():o.selected({files:v.value,ref:this});if(e.useChips===!0)return v.value.length===0?G():v.value.map((F,$)=>B(Ae,{key:"file-"+$,removable:u.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{C($)}},()=>B("span",{class:"ellipsis",textContent:F.name})));const r=e.displayValue!==void 0?e.displayValue:z.value;return r.length>0?[B("div",{class:e.inputClass,style:e.inputStyle,textContent:r})]:G()}function pe(){const r={ref:m,...A.value,...V.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:se};return e.multiple===!0&&(r.multiple=!0),B("input",r)}return Object.assign(u,{fieldClass:P,emitValue:g,hasValue:q,inputRef:m,innerValue:v,floatingLabel:h(()=>q.value===!0||oe(e.displayValue)),computedCounter:h(()=>{if(e.counterLabel!==void 0)return e.counterLabel(D.value);const r=e.maxFiles;return`${v.value.length}${r!==void 0?" / "+r:""} (${t.value})`}),getControlChild:()=>x("file"),getControl:()=>{const r={ref:u.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return u.editable.value===!0&&Object.assign(r,{onDragover:b,onDragleave:S,onKeydown:y,onKeyup:ee}),B("div",r,[pe()].concat(fe()))}}),Object.assign(a,{removeAtIndex:C,removeFile:R,getNativeElement:()=>m.value}),Ie(u)}}),Ye=E({__name:"ImportInput",setup(e){const{log:o,consoleDebug:s}=H(),{confirmDialog:_}=Z(),a=U(null),u=10485760;function m(n){var V,v,q,z,t,D,A;const b=((v=(V=n[0])==null?void 0:V.file)==null?void 0:v.name)||void 0,S=((z=(q=n[0])==null?void 0:q.file)==null?void 0:z.size)||void 0,w=((D=(t=n[0])==null?void 0:t.file)==null?void 0:D.type)||void 0,x=((A=n[0])==null?void 0:A.failedPropValidation)||void 0;s(n),o.warn(`Cannot import ${b}`,{name:x,message:`NAME: ${b}, SIZE: ${S}, TYPE: ${w}`,stack:"onRejectedImport"})}function l(){_("Import",`Import file "${a.value.name}" and attempt to load data from it?`,M.INFO,j.INFO,async()=>{try{await i()}catch(n){o.error("onImport",n)}})}async function i(){const n=await a.value.text(),b=JSON.parse(n),S=Object.values(k),w=S.reduce((x,V)=>({...x,[V]:b[V]||[]}),{});s(w),await Promise.all(S.map(x=>{x!==k.LOGS&&x!==k.SETTINGS&&T.bulkAdd(x,w[x])}))}return(n,b)=>(I(),N(d(We),{modelValue:a.value,"onUpdate:modelValue":b[2]||(b[2]=S=>a.value=S),dense:"",outlined:"",counter:"","bottom-slots":"",label:"File","max-file-size":u,accept:"application/json",onRejected:m},{before:O(()=>[f(d(X),{disable:!a.value,label:"Import",color:"primary",class:"q-mr-xs",onClick:b[0]||(b[0]=S=>l())},null,8,["disable"])]),after:O(()=>[f(ne,{name:d(M).CLOSE,onClick:b[1]||(b[1]=me(S=>a.value=null,["stop"])),class:"cursor-pointer"},null,8,["name"])]),_:1},8,["modelValue"]))}});function ie(e){setTimeout(()=>{window.URL.revokeObjectURL(e.href)},1e4),e.remove()}function Je(e,o,s={}){const{mimeType:_,byteOrderMark:a,encoding:u}=typeof s=="string"?{mimeType:s}:s,m=u!==void 0?new TextEncoder(u).encode([o]):o,l=a!==void 0?[a,m]:[m],i=new Blob(l,{type:_||"application/octet-stream"}),n=document.createElement("a");n.href=window.URL.createObjectURL(i),n.setAttribute("download",e),typeof n.download>"u"&&n.setAttribute("target","_blank"),n.classList.add("hidden"),n.style.position="fixed",document.body.appendChild(n);try{return n.click(),ie(n),!0}catch(b){return ie(n),b}}const He=E({__name:"ExportInput",setup(e){const{log:o,consoleDebug:s}=H(),{confirmDialog:_}=Z(),a=U("");function u(){let l=`export-${new Date().toISOString().split("T")[0]}`;a.value&&a.value.length&&(l=a.value),l+=".json",_("Export",`Export the file "${l}" with your data?`,M.INFO,j.INFO,async()=>{try{await m(l)}catch(i){o.error("onExport",i)}})}async function m(l){const i=Object.values(k),n=await Promise.all(i.map(w=>T.getAll(w))),b=i.reduce((w,x,V)=>({...w,[x]:n[V]}),{});if(s(b),Je(l,JSON.stringify(b),{encoding:"UTF-8",mimeType:"application/json"})===!0)s("File downloaded succesfully!");else throw new Error("Browser denied file download")}return(l,i)=>(I(),N(d(Oe),{modelValue:a.value,"onUpdate:modelValue":i[2]||(i[2]=n=>a.value=n),dense:"",outlined:"",placeholder:"Optional Name"},{before:O(()=>[f(d(X),{label:"Export",color:"primary",class:"q-mr-xs",onClick:i[0]||(i[0]=n=>u())})]),after:O(()=>[f(ne,{name:d(M).CLOSE,onClick:i[1]||(i[1]=me(n=>a.value="",["stop"])),class:"cursor-pointer"},null,8,["name"])]),_:1},8,["modelValue"]))}}),Ze=p("div",{class:"text-h6 q-mb-sm"},"Import & Export",-1),Xe=p("div",{class:"q-mb-md"},"You can import data into the database from a JSON file.",-1),et=p("div",{class:"q-mb-md"},"You can export the entire database as a JSON file.",-1),tt=E({__name:"ImportExportSection",setup(e){return(o,s)=>(I(),N(d(Q),null,{default:O(()=>[Ze,Xe,f(Ye),et,f(He)]),_:1}))}}),at=E({__name:"ClearAllBtn",setup(e){const{log:o}=H(),{confirmDialog:s}=Z(),_=ue(),a=re();async function u(){s("Clear All","Permanetly remove all app data from the database?",M.DELETE,j.ERROR,async()=>{try{await Promise.all(Object.values(k).map(m=>T.clear(m))),await _.initSettings(T),a.dark.set(_.darkMode)}catch(m){o.error("ClearAllBtn:onClearAll",m)}})}return(m,l)=>(I(),N(d(X),{label:"Clear All",color:d(j).ERROR,onClick:l[0]||(l[0]=i=>u())},null,8,["color"]))}}),nt=E({__name:"DeleteDBBtn",setup(e){const{log:o}=H(),{confirmDialog:s,dismissDialog:_}=Z();async function a(){s("Delete Database","Delete the underlining Dexie database? This only needs to be done to correct schema changes in newer versions of the app. All data will be lost.",M.DELETE,j.ERROR,async()=>{try{await T.deleteDatabase(),u()}catch(m){o.error("DeleteDBBtn:onDeleteDB",m)}})}function u(){_("Reload Reminder","Please reload the website now.",M.INFO,j.INFO)}return(m,l)=>(I(),N(d(X),{label:"Delete Database",color:d(j).ERROR,onClick:l[0]||(l[0]=i=>a())},null,8,["color"]))}}),lt=p("div",{class:"text-h6 q-mb-sm"},"DANGER ZONE",-1),st=p("div",{class:"q-mb-md"},[p("span",null,"Permanetly delete all of your data from the database using Clear All."),p("span",null," Permanetly delete your data and the underlining database using Delete Database (requires site reload). "),p("span",null," None of the actions in this section can be undone. Export your data before proceeding. ")],-1),ot={class:"q-mt-md"},it=E({__name:"DangerZoneSection",setup(e){return(o,s)=>(I(),N(d(Q),null,{default:O(()=>[p("div",null,[lt,st,p("div",null,[f(at)]),p("div",ot,[f(nt)])])]),_:1}))}}),rt={class:"row justify-center"},ut={class:"col-12"},ct=E({__name:"SettingsPage",setup(e){return(o,s)=>(I(),N(d($e),{padding:""},{default:O(()=>[p("div",rt,[p("div",ut,[f(Ne,null,{default:O(()=>[f(Me),f(ze),f(ae),f(Ue),f(ae),f(tt),f(ae),f(it)]),_:1})])])]),_:1}))}}),vt=E({__name:"SettingsView",setup(e){return(o,s)=>(I(),N(ct))}});export{vt as default};
