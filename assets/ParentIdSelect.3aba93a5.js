import{Q as f}from"./QSelect.c54da541.js";import{d as v,s as b,ad as g,H as u,ai as y,aY as D,D as S,bE as P,o as T,c as _,u as p}from"./index.3bb17302.js";import{b as k}from"./validators.51e7c766.js";import"./QChip.1015c209.js";import"./QItemSection.22a6a7ee.js";import"./QMenu.a33633d0.js";import"./selection.7371cec7.js";import"./format.3e32b8d9.js";const A=v({__name:"ParentIdSelect",setup(B){const{log:m}=b(),e=g(),o=u(null),l=u([]);y(async()=>{var n,a,r,d;try{const s=D.getParentTable(e.table);if(s){const c=(await S.getAll(s)).sort((t,i)=>t.name.localeCompare(i.name));if(l.value=c.map(t=>({value:t.id,label:`${t.name} (${P(t.id,4,"*")})`})),(n=e.selected)!=null&&n.parentId){const t=(r=(a=l.value)==null?void 0:a.find(i=>i.value===e.selectedItem.parentId))==null?void 0:r.value;t?(e.temporaryItem.parentId=t,e.validateItem.parentId=!0):(e.temporaryItem.parentId=null,e.validateItem.parentId=!1)}else((d=l.value)==null?void 0:d.length)>0?(e.temporaryItem.parentId=l.value[0].value,e.validateItem.parentId=!0):(e.temporaryItem.parentId=null,e.validateItem.parentId=!1)}else m.error("No parent table to make selection",{name:"ParentIdSelect:MissingParentTable"})}catch(s){m.error("ParentIdSelect:onMounted",s)}});function I(){var n;e.validateItem.parentId=!!((n=o==null?void 0:o.value)!=null&&n.validate())}return(n,a)=>(T(),_(p(f),{modelValue:p(e).temporaryItem.parentId,"onUpdate:modelValue":a[0]||(a[0]=r=>p(e).temporaryItem.parentId=r),ref_key:"inputRef",ref:o,label:"Parent",options:l.value,rules:[r=>p(k)(r)||"* Required"],"emit-value":"","map-options":"","options-dense":"",dense:"",outlined:"",color:"primary",class:"q-mb-xs",onBlur:a[1]||(a[1]=r=>I())},null,8,["modelValue","options","rules"]))}});export{A as default};
