import{d as y,o as g,c as k,w as S,p as R,t as N,a as i,u as t,b as X,I as w,Q as A,r as f,n as x,af as F,C as O,D as E,l as d,F as C,h as V,i as B,m as W,aq as M,f as T,ag as D,B as q,N as H,x as Q,ar as P,g as L,O as U,j as K,R as j}from"./index.6bf17d55.js";import{Q as z}from"./QPage.a383d061.js";import{i as $}from"./validators.06a91c63.js";const Y={class:"text-h6 q-mb-sm"},G=y({__name:"ActiveReminderSection",props:{exerciseName:null},setup(n){return(a,o)=>(g(),k(t(A),{class:"q-py-sm"},{default:S(()=>[R("div",Y,N(n.exerciseName),1),i(t(X),{name:t(w).ACTIVE_NOTIFY,color:"primary",size:"xl"},null,8,["name"])]),_:1}))}}),J=y({__name:"ActiveWeightRepsItems",props:{index:null,weight:null,reps:null,activeExerciseRecordId:null,weightHint:null,repsHint:null},setup(n){const a=n,o=f(null),m=f(null),v=f(a.weight),e=f(a.reps),s="Invalid";async function l(){if(a.activeExerciseRecordId){const I=await E.getFirstByField(d.ACTIVE_EXERCISES,C.ID,a.activeExerciseRecordId),c=(I==null?void 0:I.weight)||[],u=(I==null?void 0:I.reps)||[];c[a.index]=v.value||0,u[a.index]=e.value||0,await E.updateById(d.ACTIVE_EXERCISES,a.activeExerciseRecordId,{weight:[...c],reps:[...u]})}r()}function r(){var I,c;(I=o==null?void 0:o.value)==null||I.validate(),(c=m==null?void 0:m.value)==null||c.validate()}return(I,c)=>(g(),x(O,null,[i(t(F),{modelValue:v.value,"onUpdate:modelValue":c[0]||(c[0]=u=>v.value=u),modelModifiers:{number:!0},ref_key:"weightInputRef",ref:o,rules:[u=>t($)(u)||s],dense:"",outlined:"",type:"number",color:"primary",class:"col",hint:n.weightHint,onBlur:c[1]||(c[1]=u=>l())},null,8,["modelValue","rules","hint"]),i(t(F),{modelValue:e.value,"onUpdate:modelValue":c[2]||(c[2]=u=>e.value=u),modelModifiers:{number:!0},ref_key:"repsInputRef",ref:m,rules:[u=>t($)(u)||s],dense:"",outlined:"",type:"number",color:"primary",class:"col",hint:n.repsHint,onBlur:c[3]||(c[3]=u=>l())},null,8,["modelValue","rules","hint"])],64))}}),Z=R("div",{class:"text-h6"},"Sets",-1),ee=R("div",{class:"text-caption"},"#",-1),te=R("div",{class:"text-caption col"},"Weight",-1),se=R("div",{class:"text-caption col"},"Reps",-1),ae={class:"text-bold q-mt-lg"},ie={align:"right"},ne=y({__name:"ActiveSetInput",props:{activeExerciseRecordId:null,activeExerciseRecordparentId:null},setup(n){const a=n,{log:o}=V(),{confirmDialog:m}=B(),v=f([]),e=f([]),s=f([]),l=f([]),r=20;W(async()=>{var u,h;try{const _=await E.getFirstByField(d.ACTIVE_EXERCISES,C.ID,a.activeExerciseRecordId);if(v.value=(_==null?void 0:_.weight)||[],e.value=(_==null?void 0:_.reps)||[],a.activeExerciseRecordId){const p=await E.getNewestByField(d.EXERCISE_RECORDS,C.PARENT_ID,a.activeExerciseRecordparentId);s.value=((u=p==null?void 0:p.weight)==null?void 0:u.map(b=>String(b||"-")))||[],l.value=((h=p==null?void 0:p.reps)==null?void 0:h.map(b=>String(b||"-")))||[]}e.value.length===0&&I()}catch(_){o.error("ActiveSetInput:onMounted",_)}});function I(){v.value.push(void 0),e.value.push(void 0)}function c(){m("Remove Set","Are you sure you want to remove the last set?",w.DELETE,H.ERROR,()=>{v.value.pop(),e.value.pop()})}return(u,h)=>(g(),x(O,null,[i(t(A),{class:"row items-start q-py-sm"},{default:S(()=>[Z,i(t(M)),i(t(T),{disable:e.value.length>=r,round:"",color:"positive",size:"sm",icon:t(w).ADD,onClick:h[0]||(h[0]=_=>I())},null,8,["disable","icon"])]),_:1}),i(t(D)),i(t(A),{class:"q-gutter-md row items-start q-py-none"},{default:S(()=>[ee,i(t(D),{vertical:""}),te,i(t(D),{vertical:""}),se]),_:1}),i(t(D)),i(t(A),null,{default:S(()=>[(g(!0),x(O,null,q(e.value,(_,p)=>(g(),x("div",{key:p,class:"q-gutter-md row items-start q-mb-sm"},[R("div",ae,N(p+1),1),i(J,{index:p,weight:v.value[p],reps:e.value[p],activeExerciseRecordId:n.activeExerciseRecordId,weightHint:s.value[p]||"-",repsHint:l.value[p]||"-"},null,8,["index","weight","reps","activeExerciseRecordId","weightHint","repsHint"])]))),128)),R("div",ie,[i(t(T),{disable:!e.value.length,round:"",color:"negative",size:"sm",icon:t(w).REMOVE,onClick:h[1]||(h[1]=_=>c())},null,8,["disable","icon"])])]),_:1})],64))}}),re={key:1},oe={class:"text-h6 q-mb-sm"},le=y({__name:"ActiveExerciseCard",props:{name:null,tracks:null,id:null,parentId:null},setup(n){const a=n,{log:o}=V(),m=Q();async function v(){try{const e=await E.getFirstByField(d.EXERCISES,C.ID,a==null?void 0:a.parentId);m.openDialog(d.EXERCISES,U.REPORT,e)}catch(e){o.error("ActiveExerciseCard:onReportDialog",e)}}return(e,s)=>(g(),k(t(L),{class:"q-mb-md"},{default:S(()=>[n.tracks===t(P).REMINDER_ONLY?(g(),k(G,{key:0,exerciseName:n.name},null,8,["exerciseName"])):(g(),x("div",re,[i(t(A),{class:"q-py-sm"},{default:S(()=>[R("div",oe,N(n.name),1),i(t(T),{round:"",flat:"",icon:t(w).REPORT,class:"absolute-top-right q-ma-sm",onClick:s[0]||(s[0]=l=>v())},null,8,["icon"])]),_:1}),i(ne,{activeExerciseRecordId:n.id,activeExerciseRecordparentId:n.parentId},null,8,["activeExerciseRecordId","activeExerciseRecordparentId"])]))]),_:1}))}}),ce=y({__name:"ActiveExercisesList",setup(n){const{log:a}=V(),o=f([]),m=f([]);W(async()=>{try{const s=(await E.getAll(d.ACTIVE_WORKOUTS))[0];o.value=await Promise.all(s==null?void 0:s.exerciseRecordIds.map(async r=>await E.getFirstByField(d.ACTIVE_EXERCISES,C.ID,r)));const l=await Promise.all(o.value.map(async r=>await E.getFirstByField(d.EXERCISES,C.ID,r.parentId)));m.value=l}catch(s){a.error("ActiveExercisesList:onMounted",s)}});function v(s){var l;return(l=m.value.find(r=>r.id===s))==null?void 0:l.name}function e(s){var l;return(l=m.value.find(r=>r.id===s))==null?void 0:l.exerciseTracks}return(s,l)=>(g(!0),x(O,null,q(o.value,r=>(g(),x("div",{key:r.id,class:"col-sm-6 col-xs-12"},[i(le,{name:v(r.parentId),tracks:e(r.parentId),id:r.id,parentId:r.parentId},null,8,["name","tracks","id","parentId"])]))),128))}}),ue={class:"row justify-center"},de={class:"col-12"},me={class:"row justify-center q-mt-lg"},ve=y({__name:"ActiveWorkoutPage",setup(n){const{log:a}=V(),{confirmDialog:o}=B(),m=K();async function v(){o("Finish Current Workout","You you ready to finish and save this workout?",w.SAVE,H.INFO,async()=>{try{const e=(await E.getAll(d.ACTIVE_WORKOUTS))[0],s=await E.getAll(d.ACTIVE_EXERCISES);e.finishedDate=new Date().toISOString(),await E.bulkAdd(d.EXERCISE_RECORDS,s),await E.add(d.WORKOUT_RECORDS,e),await E.clear(d.ACTIVE_EXERCISES),await E.clear(d.ACTIVE_WORKOUTS),m.push({name:j.DASHBOARD})}catch(e){a.error("ActiveWorkoutPage:finishWorkout",e)}})}return(e,s)=>(g(),k(t(z),{padding:""},{default:S(()=>[R("div",ue,[R("div",de,[i(ce)])]),R("div",me,[i(T,{label:"Finish Workout",color:"positive",onClick:s[0]||(s[0]=l=>v())})])]),_:1}))}}),ge=y({__name:"ActiveWorkoutView",setup(n){return(a,o)=>(g(),k(ve))}});export{ge as default};
