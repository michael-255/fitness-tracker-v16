import{d as B,ab as C,G as I,o as g,B as x,a as o,u as t,Z as b,F as V,s as A,v as M,bw as f,ah as W,aj as q,D as Q,x as F,a9 as O,c as k,w as d,Q as h,bq as L,g as N,I as _,_ as w,ai as $,f as m,t as z,h as R,N as D}from"./index.66b77c2e.js";import{c as T}from"./validators.13905387.js";const G=B({__name:"WeightRepsItem",props:{index:null,weight:null,reps:null},setup(S){const i=S,l=C(),u=I(null),e=I(null),n=I(i.weight),c=I(i.reps),p="Invalid";function y(){l.temporaryItem.weight[i.index]=n.value,l.temporaryItem.reps[i.index]=c.value,E()}function E(){var r,s;l.validateItem.weight=!!((r=u==null?void 0:u.value)!=null&&r.validate()),l.validateItem.reps=!!((s=e==null?void 0:e.value)!=null&&s.validate()),l.validateItem.distance=!0,l.validateItem.duration=!0}return(r,s)=>(g(),x(V,null,[o(t(b),{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=a=>n.value=a),modelModifiers:{number:!0},ref_key:"weightInputRef",ref:u,rules:[a=>t(T)(a)||p],dense:"",outlined:"",type:"number",color:"primary",class:"col",onBlur:s[1]||(s[1]=a=>y())},null,8,["modelValue","rules"]),o(t(b),{modelValue:c.value,"onUpdate:modelValue":s[2]||(s[2]=a=>c.value=a),modelModifiers:{number:!0},ref_key:"repsInputRef",ref:e,rules:[a=>t(T)(a)||p],dense:"",outlined:"",type:"number",color:"primary",class:"col",onBlur:s[3]||(s[3]=a=>y())},null,8,["modelValue","rules"])],64))}}),H=m("div",{class:"text-h6"},"Sets",-1),P=m("div",{class:"text-caption"},"#",-1),U=m("div",{class:"text-caption col"},"Weight",-1),j=m("div",{class:"text-caption col"},"Reps",-1),X={class:"text-bold q-mt-lg"},Y={align:"right"},Z=m("div",null,"Exercise tracking is set to confirmation only",-1),ee=B({__name:"SetInput",setup(S){const{log:i}=A(),{confirmDialog:l,dismissDialog:u}=M(),e=C(),n=I(f.CONFIRMATION_ONLY),c=20;W(()=>{p()});function p(){try{const r=e.selectedItem.weight,s=e.selectedItem.reps;e.temporaryItem.weight=r&&r.length>0?[...e.selectedItem.weight]:[],e.temporaryItem.reps=s&&s.length>0?[...e.selectedItem.reps]:[],e.validateItem.weight=!0,e.validateItem.reps=!0}catch(r){i.error("SetInput:initializeTemporaryItem",r)}}function y(){n.value===f.WEIGHT_AND_REPS?(e.temporaryItem.weight.push(void 0),e.temporaryItem.reps.push(void 0),e.validateItem.weight=!1,e.validateItem.reps=!1):i.info("Exercise does not support sets")}function E(){n.value===f.WEIGHT_AND_REPS&&e.validateItem.weight&&e.validateItem.reps?l("Remove Set","Are you sure you want to remove the last set?",_.DELETE,D.ERROR,()=>{e.temporaryItem.weight.pop(),e.temporaryItem.reps.pop()}):u("Validation Errors","Cannot remove any sets until validation errors are cleared.",_.WARN,D.WARN)}return q(()=>{var r;return(r=e==null?void 0:e.temporaryItem)==null?void 0:r.parentId},async r=>{var s;try{if(r){const a=(s=await Q.getFirstByField(F.EXERCISES,O.ID,r))==null?void 0:s.exerciseTracks;n.value=a,p()}}catch(a){i.critical("Exercise parent watcher",a)}},{immediate:!0}),(r,s)=>n.value===t(f).WEIGHT_AND_REPS?(g(),k(t(R),{key:0},{default:d(()=>[o(t(h),{class:"row items-start q-py-sm"},{default:d(()=>[H,o(t(L)),o(t(N),{disable:t(e).temporaryItem.weight.length>=c,round:"",color:"positive",size:"sm",icon:t(_).ADD,onClick:s[0]||(s[0]=a=>y())},null,8,["disable","icon"])]),_:1}),o(t(w)),o(t(h),{class:"q-gutter-md row items-start q-py-none"},{default:d(()=>[P,o(t(w),{vertical:""}),U,o(t(w),{vertical:""}),j]),_:1}),o(t(w)),o(t(h),null,{default:d(()=>[(g(!0),x(V,null,$(t(e).temporaryItem.reps,(a,v)=>(g(),x("div",{key:v,class:"q-gutter-md row items-start q-mb-sm"},[m("div",X,z(v+1),1),o(G,{index:v,weight:t(e).temporaryItem.weight[v],reps:t(e).temporaryItem.reps[v]},null,8,["index","weight","reps"])]))),128)),m("div",Y,[o(t(N),{disable:!t(e).temporaryItem.reps.length,round:"",color:"negative",size:"sm",icon:t(_).REMOVE,onClick:s[1]||(s[1]=a=>E())},null,8,["disable","icon"])])]),_:1})]),_:1})):(g(),k(t(R),{key:1},{default:d(()=>[o(t(h),{class:"row items-start"},{default:d(()=>[Z]),_:1})]),_:1}))}});export{ee as default};
