import{Q as f}from"./QSelect.95d9b431.js";import{d as v,h as b,x as g,r as u,m as y,b2 as D,D as S,bA as P,o as T,c as _,u as p}from"./index.2a13561f.js";import{c as k}from"./validators.06a91c63.js";import"./QChip.47e4fd67.js";import"./QItemSection.e8b26758.js";import"./QMenu.c5e3915c.js";import"./selection.bcf1322b.js";import"./format.3e32b8d9.js";const w=v({__name:"ParentIdSelect",setup(x){const{log:i}=b(),e=g(),o=u(null),l=u([]);y(async()=>{var n,a,r,d;try{const s=D.getParentTable(e.table);if(s){const c=(await S.getAll(s)).sort((t,m)=>t.name.localeCompare(m.name));if(l.value=c.map(t=>({value:t.id,label:`${t.name} (${P(t.id,4,"*")})`})),(n=e.selectedItem)!=null&&n.parentId){const t=(r=(a=l.value)==null?void 0:a.find(m=>m.value===e.selectedItem.parentId))==null?void 0:r.value;t?(e.temporaryItem.parentId=t,e.validateItem.parentId=!0):(e.temporaryItem.parentId=null,e.validateItem.parentId=!1)}else((d=l.value)==null?void 0:d.length)>0?(e.temporaryItem.parentId=l.value[0].value,e.validateItem.parentId=!0):(e.temporaryItem.parentId=null,e.validateItem.parentId=!1)}else i.error("No parent table to make selection",{name:"ParentIdSelect:MissingParentTable"})}catch(s){i.error("ParentIdSelect:onMounted",s)}});function I(){var n;e.validateItem.parentId=!!((n=o==null?void 0:o.value)!=null&&n.validate())}return(n,a)=>(T(),_(p(f),{modelValue:p(e).temporaryItem.parentId,"onUpdate:modelValue":a[0]||(a[0]=r=>p(e).temporaryItem.parentId=r),ref_key:"inputRef",ref:o,label:"Parent",options:l.value,rules:[r=>p(k)(r)||"* Required"],"emit-value":"","map-options":"","options-dense":"",dense:"",outlined:"",color:"primary",class:"q-mb-xs",onBlur:a[1]||(a[1]=r=>I())},null,8,["modelValue","options","rules"]))}});export{w as default};
