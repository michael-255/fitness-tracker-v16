import{d as C,x as B,r as g,o as I,n as x,a as o,u as t,af as k,C as V,h as A,i as M,bz as f,m as W,X as Q,D as q,l as F,F as O,c as N,w as d,Q as h,bt as z,f as R,I as _,ag as w,B as L,p as m,t as $,g as b,N as D}from"./index.04684acb.js";import{c as T}from"./validators.13905387.js";const G=C({__name:"WeightRepsItem",props:{index:null,weight:null,reps:null},setup(S){const l=S,i=B(),u=g(null),e=g(null),n=g(l.weight),c=g(l.reps),p="Invalid";function y(){i.temporaryItem.weight[l.index]=n.value,i.temporaryItem.reps[l.index]=c.value,E()}function E(){var a,s;i.validateItem.weight=!!((a=u==null?void 0:u.value)!=null&&a.validate()),i.validateItem.reps=!!((s=e==null?void 0:e.value)!=null&&s.validate()),i.validateItem.distance=!0,i.validateItem.duration=!0}return(a,s)=>(I(),x(V,null,[o(t(k),{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=r=>n.value=r),modelModifiers:{number:!0},ref_key:"weightInputRef",ref:u,rules:[r=>t(T)(r)||p],dense:"",outlined:"",type:"number",color:"primary",class:"col",onBlur:s[1]||(s[1]=r=>y())},null,8,["modelValue","rules"]),o(t(k),{modelValue:c.value,"onUpdate:modelValue":s[2]||(s[2]=r=>c.value=r),modelModifiers:{number:!0},ref_key:"repsInputRef",ref:e,rules:[r=>t(T)(r)||p],dense:"",outlined:"",type:"number",color:"primary",class:"col",onBlur:s[3]||(s[3]=r=>y())},null,8,["modelValue","rules"])],64))}}),H=m("div",{class:"text-h6"},"Sets",-1),P=m("div",{class:"text-caption"},"#",-1),U=m("div",{class:"text-caption col"},"Weight",-1),X=m("div",{class:"text-caption col"},"Reps",-1),Y={class:"text-bold q-mt-lg"},j={align:"right"},J=m("div",null,"Exercise tracking is set to confirmation only",-1),ee=C({__name:"SetInput",setup(S){const{log:l}=A(),{confirmDialog:i,dismissDialog:u}=M(),e=B(),n=g(f.CONFIRMATION_ONLY),c=20;W(()=>{p()});function p(){try{const a=e.selectedItem.weight,s=e.selectedItem.reps;e.temporaryItem.weight=a&&a.length>0?[...e.selectedItem.weight]:[],e.temporaryItem.reps=s&&s.length>0?[...e.selectedItem.reps]:[],e.validateItem.weight=!0,e.validateItem.reps=!0}catch(a){l.error("SetInput:initializeTemporaryItem",a)}}function y(){n.value===f.WEIGHT_AND_REPS?(e.temporaryItem.weight.push(void 0),e.temporaryItem.reps.push(void 0),e.validateItem.weight=!1,e.validateItem.reps=!1):l.info("Exercise does not support sets")}function E(){n.value===f.WEIGHT_AND_REPS&&e.validateItem.weight&&e.validateItem.reps?i("Remove Set","Are you sure you want to remove the last set?",_.DELETE,D.ERROR,()=>{e.temporaryItem.weight.pop(),e.temporaryItem.reps.pop()}):u("Validation Errors","Cannot remove any sets until validation errors are cleared.",_.WARN,D.WARN)}return Q(()=>{var a;return(a=e==null?void 0:e.temporaryItem)==null?void 0:a.parentId},async a=>{var s;try{if(a){const r=(s=await q.getFirstByField(F.EXERCISES,O.ID,a))==null?void 0:s.exerciseTracks;n.value=r,p()}}catch(r){l.critical("Exercise parent watcher",r)}},{immediate:!0}),(a,s)=>n.value===t(f).WEIGHT_AND_REPS?(I(),N(t(b),{key:0},{default:d(()=>[o(t(h),{class:"row items-start q-py-sm"},{default:d(()=>[H,o(t(z)),o(t(R),{disable:t(e).temporaryItem.weight.length>=c,round:"",color:"positive",size:"sm",icon:t(_).ADD,onClick:s[0]||(s[0]=r=>y())},null,8,["disable","icon"])]),_:1}),o(t(w)),o(t(h),{class:"q-gutter-md row items-start q-py-none"},{default:d(()=>[P,o(t(w),{vertical:""}),U,o(t(w),{vertical:""}),X]),_:1}),o(t(w)),o(t(h),null,{default:d(()=>[(I(!0),x(V,null,L(t(e).temporaryItem.reps,(r,v)=>(I(),x("div",{key:v,class:"q-gutter-md row items-start q-mb-sm"},[m("div",Y,$(v+1),1),o(G,{index:v,weight:t(e).temporaryItem.weight[v],reps:t(e).temporaryItem.reps[v]},null,8,["index","weight","reps"])]))),128)),m("div",j,[o(t(R),{disable:!t(e).temporaryItem.reps.length,round:"",color:"negative",size:"sm",icon:t(_).REMOVE,onClick:s[1]||(s[1]=r=>E())},null,8,["disable","icon"])])]),_:1})]),_:1})):(I(),N(t(b),{key:1},{default:d(()=>[o(t(h),{class:"row items-start"},{default:d(()=>[J]),_:1})]),_:1}))}});export{ee as default};
